!function(t){var i={};function e(s){if(i[s])return i[s].exports;var r=i[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,e),r.l=!0,r.exports}e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var r in t)e.d(s,r,function(i){return t[i]}.bind(null,r));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=44)}({0:function(t,i,e){"use strict";e.d(i,"e",(function(){return o})),e.d(i,"g",(function(){return c})),e.d(i,"c",(function(){return u})),e.d(i,"r",(function(){return m})),e.d(i,"t",(function(){return f})),e.d(i,"n",(function(){return x})),e.d(i,"h",(function(){return h})),e.d(i,"i",(function(){return n})),e.d(i,"l",(function(){return p})),e.d(i,"u",(function(){return y})),e.d(i,"s",(function(){return g})),e.d(i,"k",(function(){return v})),e.d(i,"q",(function(){return b})),e.d(i,"p",(function(){return w})),e.d(i,"b",(function(){return T})),e.d(i,"d",(function(){return E})),e.d(i,"o",(function(){return z})),e.d(i,"m",(function(){return A})),e.d(i,"a",(function(){return R})),e.d(i,"f",(function(){return S})),e.d(i,"j",(function(){return U}));class s{constructor(t,i){this.x=t||0,this.y=i||0}clone(){return new s(this.x,this.y)}copy(t){this.set(t.x,t.y)}equals(t){return t.x===this.x&&t.y===this.y}set(t,i){this.x=t||0,this.y=i||0!==i?this.x:0}}class r{constructor(t,i,e,s){this.x=t||0,this.y=i||0,this.width=e||0,this.height=s||0}}class a{constructor(t,i,e,s,r,a){this.a=t||1,this.b=i||0,this.c=e||0,this.d=s||1,this.tx=r||0,this.ty=a||0}toArray(t,i){this.array||(this.array=new Float32Array(9));var e=i||this.array;return t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0,e[8]=1),e}apply(t,i){i=i||new s;var e=t.x,r=t.y;return i.x=this.a*e+this.c*r+this.tx,i.y=this.b*e+this.d*r+this.ty,i}applyInverse(t,i){i=i||new s;var e=1/(this.a*this.d+this.c*-this.b),r=t.x,a=t.y;return i.x=this.d*e*r+-this.c*e*a+(this.ty*this.c-this.tx*this.d)*e,i.y=this.a*e*a+-this.b*e*r+(-this.ty*this.a+this.tx*this.b)*e,i}translate(t,i){return this.tx+=t,this.ty+=i,this}scale(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this}rotate(t){var i=Math.cos(t),e=Math.sin(t),s=this.a,r=this.c,a=this.tx;return this.a=s*i-this.b*e,this.b=s*e+this.b*i,this.c=r*i-this.d*e,this.d=r*e+this.d*i,this.tx=a*i-this.ty*e,this.ty=a*e+this.ty*i,this}append(t){var i=this.a,e=this.b,s=this.c,r=this.d;return this.a=t.a*i+t.b*s,this.b=t.a*e+t.b*r,this.c=t.c*i+t.d*s,this.d=t.c*e+t.d*r,this.tx=t.tx*i+t.ty*s+this.tx,this.ty=t.tx*e+t.ty*r+this.ty,this}setTransform(t,i,e,s,r,a,n){var h=Math.sin(n),o=Math.cos(n),c=o*r,u=h*r,d=-h*a,l=o*a;return this.a=c+d,this.b=u+l,this.c=c+d,this.d=u+l,this.tx=t+(e*c+s*d),this.ty=i+(e*u+s*l),this}prepend(t){var i=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var e=this.a,s=this.c;this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this}invert(){var t=this.a,i=this.b,e=this.c,s=this.d,r=this.tx,a=t*s-i*e;return this.a=s/a,this.b=-i/a,this.c=-e/a,this.d=t/a,this.tx=(e*this.ty-s*r)/a,this.ty=-(t*this.ty-i*r)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){var t=new a;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copy(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}}class n{constructor(t,i,e){this.x=t||0,this.y=i||0,this.z=e||0}set(t,i,e){return this.x=t,this.y=i,this.z=e,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this}multiplyVectors(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}setLength(t){return this.multiplyScalar(t/this.length())}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}normalize(){return this.divideScalar(this.length())}distanceToSquared(t){var i=this.x-t.x,e=this.y-t.y,s=this.z-t.z;return i*i+e*e+s*s}limit(t){return this.lengthSq()>t*t&&(this.normalize(),this.mult(t)),this}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}}class h{constructor(){this.reset()}reset(){this.m=[1,0,0,1,0,0]}multiply(t){var i=this.m[0]*t.m[0]+this.m[2]*t.m[1],e=this.m[1]*t.m[0]+this.m[3]*t.m[1],s=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],a=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],n=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];this.m[0]=i,this.m[1]=e,this.m[2]=s,this.m[3]=r,this.m[4]=a,this.m[5]=n}invert(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=this.m[3]*t,e=-this.m[1]*t,s=-this.m[2]*t,r=this.m[0]*t,a=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),n=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=i,this.m[1]=e,this.m[2]=s,this.m[3]=r,this.m[4]=a,this.m[5]=n}rotate(t){var i=Math.cos(t),e=Math.sin(t),s=this.m[0]*i+this.m[2]*e,r=this.m[1]*i+this.m[3]*e,a=this.m[0]*-e+this.m[2]*i,n=this.m[1]*-e+this.m[3]*i;this.m[0]=s,this.m[1]=r,this.m[2]=a,this.m[3]=n}translate(t,i){this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i}translateAndRotate(t,i,e){var s=Math.cos(e),r=Math.sin(e),a=this.m[0]*s+this.m[2]*r,n=this.m[1]*s+this.m[3]*r,h=this.m[0]*-r+this.m[2]*s,o=this.m[1]*-r+this.m[3]*s;this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this.m[0]=a,this.m[1]=n,this.m[2]=h,this.m[3]=o}scale(t,i){this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i}transformPoint(t,i){var e=t,s=i;return[t=e*this.m[0]+s*this.m[2]+this.m[4],i=e*this.m[1]+s*this.m[3]+this.m[5]]}}const o=Math.PI,c=2*o,u=o/2,d=o/4,l=o/180;function m(t,i,e){let s=Math.floor(Math.random()*(i-t))+t;return e&&(s=Math.random()*(i-t)+t),s}function f(t,i){return t/100*i}function x(t,i){return t/i*100}function p(t,i){const e=document.createElement("canvas"),s=e.getContext("2d");if(i=i||{},e.width=i.w||window.innerWidth,e.height=i.h||window.innerHeight,e.style.position=i.position||"absolute",e.style.top=i.top||0,e.style.left=i.left||0,e.style.zIndex=i.zi||9,i.css)for(var r in i.css)e.style[r]=i.css[r];return s.font=i.font||"12px Inconsolata",t&&t.appendChild(e),{container:t,canvas:e,w:e.width,h:e.height,ctx:s,center:{x:e.width/2,y:e.height/2}}}function y(t,i,e,s,r){var a=document.createElement("ul"),n="";a.id="years",a.style.zIndex=99999;for(var h=t;h<=i;h++){var o=document.createElement("li"),c=document.createTextNode(h);h===e&&(o.className="current",n=o),o.appendChild(c),a.appendChild(o),o.addEventListener("click",s,!1)}r(a,n)}function g(t,i,e){e=e||"current",t&&t.classList.remove(e),i.classList.add(e)}function v(t){for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="",s=0;s<t.length;){var r,a,n=255&t.charCodeAt(s++),h=255&t.charCodeAt(s++),o=255&t.charCodeAt(s++),c=n>>2,u=(3&n)<<4|h>>4;isNaN(h)?r=a=64:(r=(15&h)<<2|o>>6,a=isNaN(o)?64:63&o),e+=i.charAt(c)+i.charAt(u)+i.charAt(r)+i.charAt(a)}return e}function b(t){return(new T).json(t)}function w(t){var i=new T;return i.req.overrideMimeType("text/plain; charset=x-user-defined"),i.getD(t).then((function(t){return void 0!==t.ret?t:t.data})).catch((function(t){console.error(t)}))}class T{constructor(){this.req=new XMLHttpRequest}abort(){this.req.abort()}json(t){return this.req.overrideMimeType("application/json"),this.getD(t).then((function(t){return void 0!==t.ret?(t.data=JSON.parse(t.data),t):JSON.parse(t.data)})).catch((function(t){console.error("Error in data request, reason:",t)}))}getD(t){if("object"==typeof t){if(!t.url)return void console.error("The request did not receive a url, instead got",t.url)}else"string"==typeof t&&t.length>0&&(t={url:t});var i,e,s=!1,r=this.req,a=t.loadingMsg||"Loading",n=t.container||document.body,h=n.querySelector(".loading");h||((h=document.createElement("div")).className="loading",n.appendChild(h));var o=!!t.loadingEle,c=o?t.loadingEle:null;if(!c){var u=n.querySelector(".loading-ele");(c=document.createElement("div")).className="loadingEle",u?h.insertBefore(u,c):h.appendChild(c)}function d(){c.style.opacity=1,h.style.zIndex=9,(i=c.querySelector(".loading-msg"))||((i=document.createElement("p")).className="loading-msg",i.innerText=a,c.appendChild(i))}function l(t){if(t.lengthComputable){s||(e=c.querySelector(".progress"))||((e=document.createElement("progress")).className="progress",e.style.zIndex=0,e.max=100,e.value=0,c.insertBefore(e,i),s=!0);var n=t.loaded/t.total*100;e.value=n,i.innerText=Math.floor(n)+"%\n"+a}else r.onprogress=null}function m(){o||(c.style.display="none"),h.style.zIndex=0}return new Promise((function(i,e){r.open("GET",t.url,!0),r.onloadstart=d,r.onprogress=l,r.onloadend=m,r.onload=function(){200===r.status?i({data:r.response,ret:t.ret}):e(r.statusText)},r.onerror=function(){e("Network Error")},r.send(null)}))}}class E{constructor(t){var i=t.width||window.innerWidth,e=t.height||window.innerHeight,s=t.zoom||11;t.center?this.center={lon:t.center.lon,lat:t.center.lat}:this.center={},this.hasCenter=null,this.updateSize(i,e,s)}updateSize(t,i,e){this.stageWidth=t,this.stageCenterY=i/2,this.zoom=e||this.zoom,this.zoomX=this.stageWidth*this.zoom,this.zoomY=this.stageCenterY*this.zoom,this.zoomRad=this.zoomX/360,this.newCenter(this.center.lon,this.center.lat)}newCenter(t,i){this.hasCenter=!1,this.convertCoordinates(t,i),this.hasCenter=!0}convertCoordinates(t,i){var e=+i*l,s=Math.log(Math.tan(d+e/2)),r=(+t+180)*this.zoomRad,a=this.zoomY-this.zoomX*s/c;return this.hasCenter?(r-=this.center.x,a-=this.center.y):(this.center.x=r,this.center.y=a),{x:r,y:a}}}function z(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,i,e,s){return i+i+e+e+s+s}));var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}function A(t){return 1/(255/t)}class R{constructor(t,i){if(!t||"[object Object]"!==Object.prototype.toString.call(t))return console.error("The first parameter needs to be an Object.","Example:","{audio1: 'audio1.mp3', audio2: 'audio2.mp3'}");window.AudioContext=window.AudioContext||window.webkitAudioContext;var e,s,r=Object.keys(t).length,a=0,n={};for(var h in this.ctx=new AudioContext,t)e=t[h],o.bind(this),document.body,s=void 0,(s=new T).req.responseType="arraybuffer",s.getD(e).then((function(t){return t})).catch((function(t){console.error("Error fetching audio file",t)}));function o(t,e){this.ctx.decodeAudioData(t,function(t){if(!t)return void console.error("Error decoding audio file:",e);var s=this.ctx.createBufferSource();s.buffer=t,n[e]=s,++a===r&&i(n)}.bind(this),(function(t){console.error("decodeAudioData error",t)}))}}source(t){return(t=this.ctx.createBufferSource()).buffer=buffer,t.connect(this.gainNode),this.gainNode.connect(this.ctx.destination),t}}class S{constructor(t,i,e){this.children=[],this.texture={},this.data=t,this.renderer=i,this.loadImg(t.url),this.setBatchSize(e)}setBatchSize(t){t>16384&&(t=16384),t>15e3&&(t=15e3),this.batchSize=t}renderWebGL(t){t.currentRenderer.render(this)}bindTexture(){var t=this.renderer.gl,i=this.texture;return i.glTexture||(i.glTexture=t.createTexture()),t.bindTexture(t.TEXTURE_2D,i.glTexture),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.img),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),i.mipmap&&i.isPowerOfTwo?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.generateMipmap(t.TEXTURE_2D)):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),i.isPowerOfTwo?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),!0}loadImg(t){this.img=new Image,this.img.onload=this.imgLoaded.bind(this),this.img.src=t}imgLoaded(){for(var t,i,e=this.img.naturalWidth,s=this.img.naturalHeight,r={loaded:!0,isPowerOfTwo:(t=e,i=s,t>0&&0==(t&t-1)&&i>0&&0==(i&i-1))},a=[],n=0;n<this.data.frames.length;n++){var h=this.data.frames[n];a.push({width:h.w,height:h.h,uvs:[h.x/e,h.y/s,(h.x+h.w)/e,(h.y+h.h)/s]})}this.renderer.frames=a,this.texture=r,this.bindTexture(),this.data.cb&&this.data.cb()}particle(t){return(t=t||{}).scale=t.scale||new s(1,1),t.alpha=t.alpha||1,t.rotation=t.rotation||0,t.x=t.x||0,t.y=t.y||0,t.frame=t.frame||0,this.children.push(t),this.children.length>this.batchSize&&this.setBatchSize(this.children.length),t}}class _{constructor(t,i,e){this.gl=t,this.size=new r(0,0,1,1),this.projectionMatrix=new a,this.resize(i,e)}resize(t,i){if(t|=0,i|=0,this.size.width!==t||this.size.height!==i){this.size.width=t,this.size.height=i;var e=this.projectionMatrix.identity();e.a=2/this.size.width,e.d=-2/this.size.height,e.tx=-1,e.ty=1}}}var M=e(3),C=e.n(M),P=e(4),B=e.n(P);class L{constructor(t){this.gl=t,this.uniforms={projectionMatrix:{}},this.attributes={};var i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,C.a),t.compileShader(i);var e=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(e,B.a),t.compileShader(e);var s=t.createProgram();t.attachShader(s,i),t.attachShader(s,e),t.linkProgram(s),t.deleteShader(i),t.deleteShader(e),this.program=s,t.useProgram(s),this.cacheUniformLocations(["projectionMatrix"]),this.cacheAttributeLocations(["aVertexPosition","aTextureCoord","aAlpha","aPositionCoord","aRotation"])}cacheUniformLocations(t){for(var i=0;i<t.length;++i)this.uniforms[t[i]]._location=this.gl.getUniformLocation(this.program,t[i])}cacheAttributeLocations(t){for(var i=0;i<t.length;++i)this.attributes[t[i]]=this.gl.getAttribLocation(this.program,t[i])}}class N{constructor(t,i){this.renderer=i,this.gl=t,this.start()}start(){var t=this.gl,i=new L(t);this.properties=[{attribute:i.attributes.aVertexPosition,size:2},{attribute:i.attributes.aPositionCoord,size:2},{attribute:i.attributes.aRotation,size:1},{attribute:i.attributes.aTextureCoord,size:2},{attribute:i.attributes.aAlpha,size:1}];for(var e=0;e<this.properties.length;e++)t.enableVertexAttribArray(e);var s=this.renderer.renderTarget.projectionMatrix;t.uniformMatrix3fv(i.uniforms.projectionMatrix._location,!1,s.toArray(!0))}render(t){t.texture;var i=t.children,e=i.length,s=t.maxSize;this.size=t.batchSize;var r=this.gl;if(0!==e){if(e>s&&(e=s),!this.data){this.initBuffers();for(var a=0;a<this.properties.length;a++){var n=this.properties[a];r.vertexAttribPointer(n.attribute,n.size,r.FLOAT,!1,4*this.stride,4*n.offset)}}this.updateData(i,e),r.bufferSubData(r.ARRAY_BUFFER,0,this.data),r.drawElements(r.TRIANGLES,6*e,r.UNSIGNED_SHORT,0)}}initBuffers(){var t=this.gl,i=0;this.stride=0;for(var e=0;e<this.properties.length;e++){var s=this.properties[e];s.offset=i,i+=s.size,this.stride+=s.size}this.data=new Float32Array(this.size*this.stride*4),t.bindBuffer(t.ARRAY_BUFFER,t.createBuffer()),t.bufferData(t.ARRAY_BUFFER,this.data,t.DYNAMIC_DRAW);for(var r=6*this.size,a=new Uint16Array(r),n=(e=0,0);e<r;e+=6,n+=4)a[e]=n,a[e+1]=n+1,a[e+2]=n+2,a[e+3]=n,a[e+4]=n+2,a[e+5]=n+3;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,t.createBuffer()),t.bufferData(t.ELEMENT_ARRAY_BUFFER,a,t.STATIC_DRAW)}updateData(t,i){this.stride;for(var e=0,s=this.data,r=this.renderer.frames,a=0;a<i;a++){var n=t[a],h=r[n.frame],o=h.width*n.scale,c=h.height*n.scale,u=n.x,d=n.y,l=n.rotation,m=h.uvs,f=n.alpha;s[e]=-o,s[++e]=-c,s[++e]=u,s[++e]=d,s[++e]=l,s[++e]=m[0],s[++e]=m[1],s[++e]=f,s[++e]=o,s[++e]=-c,s[++e]=u,s[++e]=d,s[++e]=l,s[++e]=m[2],s[++e]=m[1],s[++e]=f,s[++e]=o,s[++e]=c,s[++e]=u,s[++e]=d,s[++e]=l,s[++e]=m[2],s[++e]=m[3],s[++e]=f,s[++e]=-o,s[++e]=c,s[++e]=u,s[++e]=d,s[++e]=l,s[++e]=m[0],s[++e]=m[3],s[++e]=f,e++}}}class U{constructor(t,i){this.container=t,i=i||{},this.width=i.width||window.innerWidth,this.height=i.height||window.innerHeight,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",t.appendChild(this.canvas);var e=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl",ctxOptions);this.gl=e,e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),this.renderTarget=new _(e,this.width,this.height),this.currentRenderer=new N(e,this),this.resize(this.width,this.height)}render(t){t.renderWebGL(this)}resize(t,i){this.width=this.canvas.width=t,this.height=this.canvas.height=i,this.gl.viewport(0,0,t,i)}}},1:function(t,i){t.exports=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},2:function(t,i){function e(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}t.exports=function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t},t.exports.default=t.exports,t.exports.__esModule=!0},3:function(t,i){t.exports="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute float aAlpha;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying float vAlpha;\n\nvoid main(void){\n  float cosine = cos(aRotation);\n  float sine = sin(aRotation);\n\n  vec3 v;\n  v.x = aVertexPosition.x * cosine - aVertexPosition.y * sine;\n  v.y = aVertexPosition.x * sine + aVertexPosition.y * cosine;\n  v.z = 1.0;\n\n  // Move\n  v.xy += aPositionCoord;\n\n  gl_Position = vec4(projectionMatrix * v, 1.0);\n\n  vTextureCoord = aTextureCoord;\n  vAlpha = aAlpha;\n}"},4:function(t,i){t.exports="precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying float vAlpha;\n\nuniform sampler2D uImage;\n\nvoid main(void){\n  vec4 color = texture2D(uImage, vTextureCoord) * vAlpha;\n  if (color.a == 0.0) discard;\n  gl_FragColor = color;\n}"},44:function(t,i,e){"use strict";e.r(i);var s=e(0),r=e(1),a=e.n(r),n=e(2),h=e.n(n),o=function(){function t(i,e,s,r){a()(this,t),this.data=e,this.canvas=i.canvas,this.ctx=i.ctx,this.minMaxValues=s,this.h=i.h,this.dataUpCounter=0,this.timeBtwnBeats=0,this.lastBeat=0,this.gap=1;for(var n=0;n<this.data.length;n++){var h=n*this.gap+.5;this.data[n].hasOwnProperty("bpm")&&(this.ctx.beginPath(),this.ctx.moveTo(h,this.h),this.ctx.strokeStyle="deeppink",this.ctx.lineTo(h,this.h+s.raw.min-this.data[n].raw-.5*this.data[n].bpm),this.ctx.strokeText(this.data[n].bpm+", "+this.data[n].raw,h-5,this.h+s.raw.min-this.data[n].raw-.5*this.data[n].bpm),this.ctx.stroke()),n>0&&this.data[n].raw>this.data[n-1].raw&&this.dataUpCounter++,this.dataUpCounter>3&&this.data[n].raw>=this.data[n-1].raw&&this.sampleSum(n)>10&&this.data[n].raw>=518?(this.dataUpCounter=0,this.ctx.beginPath(),this.ctx.moveTo(h,this.h),this.ctx.lineTo(h,this.h+s.raw.min-this.data[n].raw),this.ctx.strokeStyle="crimson",this.ctx.stroke(),this.printText(h,n),this.timeBtwnBeats>55&&this.errorSampleRange(h),this.timeBtwnBeats=0,this.lastBeat=h,r(this.data[n].raw)):(this.timeBtwnBeats++,this.ctx.beginPath(),this.ctx.moveTo(h,this.h),this.ctx.lineTo(h,this.h+s.raw.min-this.data[n].raw),this.data[n].raw<490?(this.ctx.strokeStyle="blue",this.printText(h,n)):518===this.data[n].raw?(this.ctx.strokeStyle="#a16ccb",this.printText(h,n)):this.ctx.strokeStyle="black",this.ctx.stroke())}this.timeBtwnBeats>55&&this.errorSampleRange(this.data.length*this.gap+.5)}return h()(t,[{key:"printText",value:function(t,i){this.ctx.strokeText(this.data[i].raw,t-5,this.h+this.minMaxValues.raw.min-this.data[i].raw-3)}},{key:"sampleSum",value:function(t){var i=0;if(t<this.data.length-1&&this.data[t].raw>this.data[t+1].raw)if(this.data.length>15&&t>15)for(var e=0;e<15;e++)i+=this.data[t-e].raw-this.data[t-e-1].raw;else if(t>15)for(var s=0;s<this.data.length;s++)i+=this.data[t-s].raw-this.data[t-s-1].raw;return i}},{key:"errorSampleRange",value:function(t){var i=this.ctx;i.save(),i.globalAlpha=.3,i.beginPath(),i.rect(this.lastBeat,0,t-this.lastBeat,this.h),i.fillStyle="green",i.fill(),i.restore()}}]),t}(),c=document.getElementById("ddd-container"),u=document.createElement("span");c.style.textAlign="center",u.className="info",c.appendChild(u);var d=window.innerWidth-100,l={raw:{min:1e5,max:0},beat:{min:1e5,max:0}},m=[],f=[],x=0,p=0,y=0;function g(t){y++,f.some((function(i){return i===t}))||f.push(t),f.sort(),v(t,"beat")}function v(t,i){t<l[i].min&&(l[i].min=t),t>l[i].max&&(l[i].max=t)}function b(){var t=Object(s.l)(c,{position:"relative",w:d,h:l.raw.max-l.raw.min+20,font:"10px Inconsolata"});return t.canvas.style.margin="0 auto",t}function w(){if(x<m.length){var t=m.slice(x,x+d),i=b();new o(i,t,l,g),requestAnimationFrame(w)}x+=d,u.innerHTML="RAW - Min: ".concat(l.raw.min," - ")+"Max: ".concat(l.raw.max," || ")+"BEATS - Min: ".concat(l.beat.min," - ")+"Max: ".concat(l.beat.max,"<br/>")+"Beats Count (peaks): ".concat(y," || ")+"Total Count: ".concat(m.length,"<br/>")+"Unique Beats #: ".concat(f.length,"<br/><br/>")}Object(s.q)({url:"../../data/pulse/heart.2.json",container:c,loadingMsg:"Loading Pulse Data"}).then((function(t){t.beats.forEach((function(t){var i=Number(t.substr(1));"S"===t.charAt(0)?(m[p]={raw:i},v(i,"raw"),p++):"B"===t.charAt(0)&&(m[p-1].bpm=i)})),w()})).catch((function(t){return console.error(t)}))}});