!function(t){var e={};function s(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([,function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.animReq=e.year=e.assets=void 0;var a=o(s(9)),i=o(s(8)),n=o(s(7)),r=s(6);function o(t){return t&&t.__esModule?t:{default:t}}var c,l,f=new DDD.DataRequest,h=document.getElementById("ddd-container"),u=document.createElement("div"),p=DDD.canvas(null),d=DDD.canvas(h),m=DDD.canvas(h),v=DDD.canvas(h),w=DDD.canvas(h),g=DDD.canvas(h);m.canvas.id="papa";var y=e.assets={};u.className="loading",p.center.y=g.center.y=p.h/1.5|0,h.appendChild(u);var x=e.year=2008,D=[],b=[],R=!1,O=e.animReq=void 0,_=0,j=4,k=0,M=new DDD.Map({zoom:8,width:g.w,height:g.h,center:{lon:-71.999996,lat:4.000002}}),q=(Date.parse(x+"/01/01 00:00:00"),Date.parse(x+1+"/01/01 00:00:00"),0);new a.default(h,function(t){u.innerHTML="",u.style.opacity=1,e.year=x=t,_=0,D=[],b=[],R=!1,0,Date.parse(x+"/01/01 00:00:00")/1e3,Date.parse(x+1+"/01/01 00:00:00")/1e3,g.ctx.clearRect(0,0,g.w,g.h),d.ctx.clearRect(0,0,d.w,d.h),p.ctx.clearRect(0,0,p.w,p.h),C(),P(),console.log(x)},f);function C(){f.json({url:"../../data/monitor/violencia-"+x+".json",container:h,loadingMsg:"Loading Violence Data",loadingEle:u}).then(function(t){b=t.data,R=!0}).catch(function(t){console.error(t)})}function P(){q===r.imgs.length&&R?(u.style.opacity=0,g.ctx.globalCompositeOperation="source-over",g.ctx.fillStyle="rgba(255, 255, 255, 1)",g.ctx.fillRect(0,0,g.w,g.h),A(),X()):e.animReq=O=requestAnimationFrame(P)}function X(){_<b.length-1?(k===j&&(E(_),k=0),_++,k++,e.animReq=O=requestAnimationFrame(X)):window.cancelAnimationFrame(O)}var I=1,Y=1;function A(){var t=(I+1)%4,s=t%4==0?1:t,a=y["papa"+I].img,i=y["papa"+s].img;Y-=.005,w.ctx.clearRect(0,0,w.w,w.h),w.ctx.globalAlpha=Y,w.ctx.drawImage(a,m.w/2-c/2-200,m.h/2-l/2,c,l),v.ctx.clearRect(0,0,v.w,v.h),v.ctx.globalAlpha=1-Y,v.ctx.drawImage(i,m.w/2-c/2-200,m.h/2-l/2,c,l),m.ctx.clearRect(0,0,m.w,m.h),m.ctx.drawImage(w.canvas,0,0),m.ctx.drawImage(v.canvas,0,0),Y<=0&&(++I>=4&&(I=1),Y=1),e.animReq=O=requestAnimationFrame(A)}function E(t){var e=b[t];if(e.hasOwnProperty("vTotal")&&e.hasOwnProperty("cat")&&e.cat.indexOf("Homicidio")>=0){var s=b[t].vTotal;if("lon"in e&&"lat"in e)for(var a=M.convertCoordinates(e.lon,e.lat),i=0;i<s;i++)D.push(new n.default(p,a,i))}if(D.length>0){p.ctx.clearRect(0,0,g.w,g.h);for(var r=0;r<D.length;r++)D[r].finished||D[r].draw();g.ctx.globalCompositeOperation="source-over",g.ctx.fillStyle="rgba(255, 255, 255, 0.01)",g.ctx.fillRect(0,0,g.w,g.h),g.ctx.globalCompositeOperation="xor",g.ctx.drawImage(p.canvas,0,0)}}!function(){C();for(var t=0;t<r.imgs.length;t++){var e=new i.default(r.imgs[t].options);e.img.onload=function(){q++},e.img.src=e.src,y[r.imgs[t].key]=e,c=m.h-50,l=m.h-50}P()}()},,,,,function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.imgs=[{key:"lines",options:{src:"/img/assets/sprites/lines-01-small.png",w:295,h:150,cols:21,rows:1,offX:4,offY:1}},{key:"shadows",options:{src:"/img/assets/sprites/shadows-sprite.png",w:318,h:300,cols:3,rows:8,offX:55,offY:14}},{key:"levit",options:{src:"/img/assets/sprites/levit.png",w:3279,h:165,cols:30,rows:1,offX:68,offY:161}},{key:"papa1",options:{src:"/img/assets/sprites/papa1.jpg",w:1200,h:1200}},{key:"papa2",options:{src:"/img/assets/sprites/papa2.jpg",w:1200,h:1200}},{key:"papa3",options:{src:"/img/assets/sprites/papa3.jpg",w:1200,h:1200}},{key:"papa4",options:{src:"/img/assets/sprites/papa4.jpg",w:1200,h:1200}}]},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s(1);function i(t,e,s){this.stage=t,this.x=e.x,this.y=e.y,this.frameX=0,this.finished=!1,this.r=-s,this.forward=!0,this.pushY=0,this.count=0}e.default=i,i.prototype.draw=function(){var t=this.stage;this.count<2*a.assets.levit.cols?(this.forward||(this.pushY+=a.assets.levit.fh/15),t.ctx.save(),t.ctx.translate(t.center.x,t.center.y),t.ctx.rotate(this.r*Math.PI/20),t.ctx.drawImage(a.assets.levit.img,this.frameX*a.assets.levit.fw,0,a.assets.levit.fw,a.assets.levit.fh,this.x-a.assets.levit.offX,this.y-a.assets.levit.offY-this.pushY,a.assets.levit.fw,a.assets.levit.fh),t.ctx.restore(),this.forward?this.frameX++:this.frameX--,this.count++,this.frameX===a.assets.levit.cols-1&&(this.forward=!1)):this.del()},i.prototype.del=function(){this.finished=!0}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.img=new Image,this.src=e.src,this.w=e.w,this.h=e.h,this.cols=e.cols,this.rows=e.rows,this.offX=e.offX,this.offY=e.offY,this.fw=this.w/this.cols|0,this.fh=this.h/this.rows|0}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var s=0;s<e.length;s++){var a=e[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,s,a){return s&&t(e.prototype,s),a&&t(e,a),e}}(),i=s(1);var n=function(){function t(e,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=e,this.current,this.reloadStage=s,this.violenceReq=a,this.menu=DDD.yearsMenu(2008,2016,i.year,this.onClick.bind(this),this.menuReady.bind(this))}return a(t,[{key:"menuReady",value:function(t,e){this.container.appendChild(t),this.current=e}},{key:"onClick",value:function(t){t.target!==this.current&&(window.cancelAnimationFrame(i.animReq),DDD.resetCurrent(this.current,t.target),this.violenceReq.abort(),this.current=t.target,this.reloadStage(t.target.textContent))}}]),t}();e.default=n}]);